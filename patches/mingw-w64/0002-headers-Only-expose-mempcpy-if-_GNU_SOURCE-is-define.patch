From 67e301bfa30c8d3527f34150a149f3e49001b9f2 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Martin=20Storsj=C3=B6?= <martin@martin.st>
Date: Mon, 19 Sep 2022 15:11:29 +0300
Subject: [PATCH 2/8] headers: Only expose mempcpy() if _GNU_SOURCE is defined
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

This matches how this function is made available on glibc too,
and matches the fortification wrapper further below in the same
file.

Signed-off-by: Martin Storsj√∂ <martin@martin.st>
---
 mingw-w64-headers/crt/string.h | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/mingw-w64-headers/crt/string.h b/mingw-w64-headers/crt/string.h
index afcaf0b4f..83e02084e 100644
--- a/mingw-w64-headers/crt/string.h
+++ b/mingw-w64-headers/crt/string.h
@@ -49,7 +49,9 @@ extern "C" {
   int __cdecl memcmp(const void *_Buf1,const void *_Buf2,size_t _Size);
   void * __cdecl memcpy(void * __restrict__ _Dst,const void * __restrict__ _Src,size_t _Size) __MINGW_ATTRIB_DEPRECATED_SEC_WARN;
   _SECIMP errno_t __cdecl memcpy_s (void *_dest,size_t _numberOfElements,const void *_src,size_t _count);
+#ifdef _GNU_SOURCE
   void * __cdecl mempcpy (void *_Dst, const void *_Src, size_t _Size);
+#endif
   void * __cdecl memset(void *_Dst,int _Val,size_t _Size);
 #ifndef	NO_OLDNAMES
   void * __cdecl memccpy(void *_Dst,const void *_Src,int _Val,size_t _Size) __MINGW_ATTRIB_DEPRECATED_MSVC2005;
-- 
2.25.1

