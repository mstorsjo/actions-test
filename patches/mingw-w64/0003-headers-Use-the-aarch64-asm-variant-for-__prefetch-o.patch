From ad07ff2ce66ea2462dfd78bc526563e722296ed4 Mon Sep 17 00:00:00 2001
From: Billy Laws <blaws05@gmail.com>
Date: Fri, 8 Sep 2023 15:37:08 +0100
Subject: [PATCH 03/30] headers: Use the aarch64 asm variant for __prefetch on
 ARM64EC

---
 mingw-w64-headers/crt/_mingw.h.in | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/mingw-w64-headers/crt/_mingw.h.in b/mingw-w64-headers/crt/_mingw.h.in
index 53d1aee05..e4c7f09ef 100644
--- a/mingw-w64-headers/crt/_mingw.h.in
+++ b/mingw-w64-headers/crt/_mingw.h.in
@@ -622,13 +622,13 @@ __MINGW_INTRIN_INLINE void __cdecl __MINGW_ATTRIB_NORETURN __fastfail(unsigned i
 #define __MINGW_PREFETCH_IMPL 1
 #endif
 #if __MINGW_PREFETCH_IMPL == 1
-#if defined(__arm__) || defined(__aarch64__)
+#if defined(__arm__) || defined(__aarch64__) || defined(__arm64ec__)
 void __cdecl __prefetch(const void *addr);
 __MINGW_INTRIN_INLINE void __cdecl __prefetch(const void *addr)
 {
 #if defined(__arm__)
   __asm__ __volatile__("pld [%0]"::"r"(addr));
-#elif defined(__aarch64__)
+#elif defined(__aarch64__) || defined(__arm64ec__)
   __asm__ __volatile__("prfm pldl1keep, [%0]"::"r"(addr));
 #endif
 }
-- 
2.25.1

